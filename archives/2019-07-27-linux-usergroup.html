<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width" data-next-head=""/><meta name="theme-color" content="#ddd4bb" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:url" content="https://koka831.github.io" data-next-head=""/><meta property="og:site_name" content="/var/log/koka" data-next-head=""/><meta name="twitter:card" content="summary" data-next-head=""/><meta name="twitter:title" content="/var/log/koka" data-next-head=""/><meta name="twitter:site" content="@k_0ka" data-next-head=""/><meta name="twitter:description" content="cat /var/log/koka &gt; /dev/null" data-next-head=""/><link rel="alternate" type="application/rss+xml" href="https://koka831.github.io/feed.xml" title="/var/log/koka RSS2.0" data-next-head=""/><title data-next-head=""></title><meta property="title" content="Linux: 画面の明るさを変更できなくなった | /var/log/koka" data-next-head=""/><meta property="og:title" content="Linux: 画面の明るさを変更できなくなった | /var/log/koka" data-next-head=""/><meta property="twitter:title" content="Linux: 画面の明るさを変更できなくなった | /var/log/koka" data-next-head=""/><meta property="description" content="バルス" data-next-head=""/><meta property="og:description" content="バルス" data-next-head=""/><meta property="twitter:description" content="バルス" data-next-head=""/><meta property="og:image" content="https://koka831.github.io/img/icon.png" data-next-head=""/><link rel="preload" href="/_next/static/css/3ad67afbba2537c6.css" as="style"/><link rel="preload" href="/_next/static/css/5709b986f32934dd.css" as="style"/><link rel="stylesheet" href="/_next/static/css/3ad67afbba2537c6.css" data-n-g=""/><link rel="stylesheet" href="/_next/static/css/5709b986f32934dd.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-8cac0b4b405cede1.js" defer=""></script><script src="/_next/static/chunks/framework-b8ed9b642a1d405a.js" defer=""></script><script src="/_next/static/chunks/main-5967226b86c09d72.js" defer=""></script><script src="/_next/static/chunks/pages/_app-87775d45a97146af.js" defer=""></script><script src="/_next/static/chunks/98bef5de-90a314e763d10677.js" defer=""></script><script src="/_next/static/chunks/230-8a10a6030a242aaa.js" defer=""></script><script src="/_next/static/chunks/772-fdba437487b25e1a.js" defer=""></script><script src="/_next/static/chunks/pages/archives/%5Bslug%5D-296f94b36904c5e2.js" defer=""></script><script src="/_next/static/RxIqu_vluEpaYq5AlkUYa/_buildManifest.js" defer=""></script><script src="/_next/static/RxIqu_vluEpaYq5AlkUYa/_ssgManifest.js" defer=""></script></head><body><div id="__next"><nav class="Header_navigation__container__QTqC2"><div class="Header_navigation___WOtz"><a href="/">/var/log/koka</a></div><div><a href="/archives">archive</a></div></nav><main class="Layout_container__p0wDU"><div class="slug_container__mEKwJ"><div class="slug_main__Z60A9"><article class="slug_article__bvmhe"><div itemScope="" class="ArticleHeader_header__container__rB6r3"><a class="ArticleHeader_post__title__2kJMT" href="/archives/2019-07-27-linux-usergroup">Linux: 画面の明るさを変更できなくなった</a><p>バルス</p><div class="ArticleHeader_flex__HuW5L"><div class="ArticleHeader_post__tags__xNlWQ"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="tags" class="svg-inline--fa fa-tags ArticleHeader_tags__icon__U0ED6" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M345 39.1L472.8 168.4c52.4 53 52.4 138.2 0 191.2L360.8 472.9c-9.3 9.4-24.5 9.5-33.9 .2s-9.5-24.5-.2-33.9L438.6 325.9c33.9-34.3 33.9-89.4 0-123.7L310.9 72.9c-9.3-9.4-9.2-24.6 .2-33.9s24.6-9.2 33.9 .2zM0 229.5V80C0 53.5 21.5 32 48 32H197.5c17 0 33.3 6.7 45.3 18.7l168 168c25 25 25 65.5 0 90.5L277.3 442.7c-25 25-65.5 25-90.5 0l-168-168C6.7 262.7 0 246.5 0 229.5zM144 144a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"></path></svg><p class="Tag_tag__zyzRy">Linux</p><p class="Tag_tag__zyzRy">udev</p></div><div class="ArticleHeader_post__dates__xh42y"><time dateTime="2019-07-27" itemProp="datePublished" class="PublishDate_post__date___a8_6">published: <!-- -->2019-07-27</time><time dateTime="2021-01-30" itemProp="datePublished" class="PublishDate_post__date___a8_6">updated: 2021-01-30</time></div></div></div><div class="slug_article__body__Y96pa"><h2 id="tl-dr"><a href="#tl-dr">TL; DR</a></h2>
<ul>
<li>作業ユーザを<code>video</code>グループに追加</li>
<li>udevのrulesを追加し<code>brightness</code>デバイスへの書き込み権限を付与</li>
</ul>
<h2 id="概要"><a href="#概要">概要</a></h2>
<p>Thinkpad X1 Carbon(2019)を購入したので，Gentooをインストールした.
が，F5, F6での明るさ調整が効かなかった. クッソまぶしい.</p>
<p>明るさ調整には<code>light</code>コマンドを用いたところ，<code>sudo light -A 5</code>のようにroot権限を用いると調整が行えた.</p>
<h2 id="解決策"><a href="#解決策">解決策</a></h2>
<ol>
<li>作業ユーザを<code>video</code>グループに追加する.</li>
</ol>
<p>usergroupは以下で確認できる.</p>
<div class="remark-highlight"><pre class="language-sh"><code class="language-sh">$ <span class="token function">cut</span> -d: <span class="token parameter variable">-f1</span> /etc/group
</code></pre></div>
<p>そのなかでもメジャーなものは以下(独断).</p>

























<table><thead><tr><th align="center">name</th><th align="center">role</th></tr></thead><tbody><tr><td align="center">wheel</td><td align="center">管理権限作業用グループ</td></tr><tr><td align="center">log</td><td align="center">/var/log/ へのアクセス用グループ</td></tr><tr><td align="center">video</td><td align="center">ビデオキャプチャ・フレームバッファアクセス</td></tr><tr><td align="center">docker</td><td align="center">docker作業用グループ</td></tr></tbody></table>
<div class="remark-highlight"><pre class="language-sh"><code class="language-sh"><span class="token function">usermod</span> <span class="token parameter variable">-aG</span> video <span class="token variable">${<span class="token environment constant">USER</span>}</span>
</code></pre></div>
<p><code>usermod</code>コマンドを用いて<code>$USER</code>をグループに追加する.<br>
例えば<code>$USER</code>を<code>docker</code>グループに追加した場合, <code>$USER</code>は<code>docker</code>の操作に管理者権限が不要となる.</p>
<p>(ただ第三者が作成したスクリプトであってもroot権限で実行できるということなので，<code>docker</code>を用いる場合には<code>newgrp</code>を用いて一時的にグループを変更するなどのほうがいいと思う. <code>docker</code>の場合権限昇格などのリスクもあるので気をつけよう．お兄さんとの約束だよ)</p>
<ol start="2">
<li><code>brightness</code>デバイスの書き込み権限を<code>video</code>グループに付与する.</li>
</ol>
<p>画面の明るさ(<code>brightness</code>)は<code>udev</code>によって管理されている.
<code>/usr/lib/udev/rules.d/xx-brightness.rules</code>を次のように記述する.</p>
<div class="remark-highlight"><pre class="language-unknown"><code class="language-unknown">ACTION==&#x26;quot;add&#x26;quot;, SUBSYSTEM==&#x26;quot;backlight&#x26;quot;, RUN+=&#x26;quot;/bin/chgrp video /sys/class/backlight/%k/brightness&#x26;quot;
ACTION==&#x26;quot;add&#x26;quot;, SUBSYSTEM==&#x26;quot;backlight&#x26;quot;, RUN+=&#x26;quot;/bin/chmod g+w /sys/class/backlight/%k/brightness&#x26;quot;</code></pre></div>
<p>これで起動時に<code>video</code>グループに対して<code>brightness</code>デバイスへの書き込み権限が付与される.</p>
<h2 id="追記"><a href="#追記">追記</a></h2>
<p>かわいい感じになりました. yay
</p><figure><img src="./img/desktop.png" alt=""><figcaption>img.1 </figcaption></figure><p></p>
<h2 id="reference"><a href="#reference">reference</a></h2>
<ul>
<li><a href="https://wiki.archlinux.jp/index.php/%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%81%A8%E3%82%B0%E3%83%AB%E3%83%BC%E3%83%97" rel="nofollow">arch linux#グループ一覧</a></li>
<li><a href="https://wiki.archlinux.org/index.php/Backlight" rel="nofollow">arch linux#brightness</a></li>
</ul></div></article><div class="CommitLogs_commit_logs__5HqJt" role="log"><h2>Commits</h2><details><summary class="CommitLogs_summary__ZlqPh"><span class="CommitLogs_commit__date__m2ycj">2021-01-30 22:18:17</span><span class="CommitLogs_commit__hash__wzS9A">35b550ae</span><span class="CommitLogs_commit__message__q7MGV">copy md</span></summary><div><div class="remark-highlight"><pre data-file="35b550ae.patch" class="language-git language-diff"><code class="language-git"><span class="token commit-sha1">commit 35b550ae83af4efaeadf33471c8ca8a32c1079c8</span>
Author: koka &#x26;<a href="mailto:lt;koka.code@gmail.com" class="token email-link">lt;koka.code@gmail.com</a>&#x26;gt;
Date:   Sat Jan 30 22:18:17 2021 +0900

  copy md

diff --git a/_posts/2019-07-27-linux-usergroup.md b/_posts/2019-07-27-linux-usergroup.md
new file mode 100644
index 0000000..0bafcf1
<span class="token deleted">--- /dev/null</span>
<span class="token inserted">+++ b/_posts/2019-07-27-linux-usergroup.md</span>
<span class="token coord">@@ -0,0 +1,65 @@</span>
<span class="token inserted">+---</span>
<span class="token inserted">+title: 'Linux: 画面の明るさを変更できなくなった'</span>
<span class="token inserted">+date: 2019-07-27</span>
<span class="token inserted">+categories:</span>
<span class="token inserted">+- diary</span>
<span class="token inserted">+tags:</span>
<span class="token inserted">+- Linux</span>
<span class="token inserted">+- udev</span>
<span class="token inserted">+description: バルス</span>
<span class="token inserted">+---</span>
<span class="token inserted">+</span>
<span class="token inserted">+## TL; DR</span>
<span class="token inserted">+- 作業ユーザを`video`グループに追加</span>
<span class="token inserted">+- udevのrulesを追加し`brightness`デバイスへの書き込み権限を付与</span>
<span class="token inserted">+</span>
<span class="token inserted">+</span>
<span class="token inserted">+## 概要</span>
<span class="token inserted">+Thinkpad X1 Carbon(2019)を購入したので，Gentooをインストールした. </span>
<span class="token inserted">+が，F5, F6での明るさ調整が効かなかった. クッソまぶしい.</span>
<span class="token inserted">+</span>
<span class="token inserted">+明るさ調整には`light`コマンドを用いたところ，`sudo light -A 5`のようにroot権限を用いると調整が行えた.</span>
<span class="token inserted">+</span>
<span class="token inserted">+## 解決策</span>
<span class="token inserted">+1. 作業ユーザを`video`グループに追加する.</span>
<span class="token inserted">+</span>
<span class="token inserted">+usergroupは以下で確認できる.</span>
<span class="token inserted">+\```sh</span>
<span class="token inserted">+$ cut -d: -f1 /etc/group</span>
<span class="token inserted">+\```</span>
<span class="token inserted">+そのなかでもメジャーなものは以下(独断).</span>
<span class="token inserted">+|name|role|</span>
<span class="token inserted">+|:---:|:---:|</span>
<span class="token inserted">+|wheel| 管理権限作業用グループ|</span>
<span class="token inserted">+|log| /var/log/ へのアクセス用グループ|</span>
<span class="token inserted">+|video| ビデオキャプチャ・フレームバッファアクセス|</span>
<span class="token inserted">+|docker| docker作業用グループ|</span>
<span class="token inserted">+</span>
<span class="token inserted">+\```sh</span>
<span class="token inserted">+usermod -aG video ${USER}</span>
<span class="token inserted">+\```</span>
<span class="token inserted">+`usermod`コマンドを用いて`$USER`をグループに追加する.  </span>
<span class="token inserted">+例えば`$USER`を`docker`グループに追加した場合, `$USER`は`docker`の操作に管理者権限が不要となる.  </span>
<span class="token inserted">+</span>
<span class="token inserted">+(ただ第三者が作成したスクリプトであってもroot権限で実行できるということなので，`docker`を用いる場合には`newgrp`を用いて一時的にグループを変更するなどのほうがいいと思う. `docker`の場合権限昇格などのリスクもあるので気をつけよう．お兄さんとの約束だよ)</span>
<span class="token inserted">+</span>
<span class="token inserted">+2. `brightness`デバイスの書き込み権限を`video`グループに付与する.</span>
<span class="token inserted">+</span>
<span class="token inserted">+画面の明るさ(`brightness`)は`udev`によって管理されている. </span>
<span class="token inserted">+`/usr/lib/udev/rules.d/xx-brightness.rules`を次のように記述する.</span>
<span class="token inserted">+</span>
<span class="token inserted">+\```</span>
<span class="token inserted">+ACTION=="add", SUBSYSTEM=="backlight", RUN+="/bin/chgrp video /sys/class/backlight/%k/brightness"</span>
<span class="token inserted">+ACTION=="add", SUBSYSTEM=="backlight", RUN+="/bin/chmod g+w /sys/class/backlight/%k/brightness"</span>
<span class="token inserted">+\```</span>
<span class="token inserted">+</span>
<span class="token inserted">+これで起動時に`video`グループに対して`brightness`デバイスへの書き込み権限が付与される.</span>
<span class="token inserted">+</span>
<span class="token inserted">+## 追記</span>
<span class="token inserted">+</span>
<span class="token inserted">+かわいい感じになりました. yay</span>
<span class="token inserted">+![](./img/desktop.png)</span>
<span class="token inserted">+</span>
<span class="token inserted">+## reference</span>
<span class="token inserted">+- [arch linux#グループ一覧](https://wiki.archlinux.jp/index.php/%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%81%A8%E3%82%B0%E3%83%AB%E3%83%BC%E3%83%97)</span>
<span class="token inserted">+- [arch linux#brightness](https://wiki.archlinux.org/index.php/Backlight)</span>
</code></pre></div></div></details></div><div class="Comments_comment__S1sQU" role="comment"><h2 class="Comments_title__494X3">Comments</h2><div id="github-comment-container"></div></div></div><aside class="slug_aside__Ow2nH"><nav class="Toc_toc__nav__MM10v" role="navigation"><ul class="Toc_toc__f9CQa"></ul></nav></aside></div></main><footer class="Footer_footer__UaG1g"><small>Code snippets licensed under MIT, unless otherwise noted.</small></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"slug":"2019-07-27-linux-usergroup","title":"Linux: 画面の明るさを変更できなくなった","categories":["diary"],"image":"https://koka831.github.io/img/icon.png","tags":["Linux","udev"],"content":"\u003ch2 id=\"tl-dr\"\u003e\u003ca href=\"#tl-dr\"\u003eTL; DR\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e作業ユーザを\u003ccode\u003evideo\u003c/code\u003eグループに追加\u003c/li\u003e\n\u003cli\u003eudevのrulesを追加し\u003ccode\u003ebrightness\u003c/code\u003eデバイスへの書き込み権限を付与\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"概要\"\u003e\u003ca href=\"#概要\"\u003e概要\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eThinkpad X1 Carbon(2019)を購入したので，Gentooをインストールした.\nが，F5, F6での明るさ調整が効かなかった. クッソまぶしい.\u003c/p\u003e\n\u003cp\u003e明るさ調整には\u003ccode\u003elight\u003c/code\u003eコマンドを用いたところ，\u003ccode\u003esudo light -A 5\u003c/code\u003eのようにroot権限を用いると調整が行えた.\u003c/p\u003e\n\u003ch2 id=\"解決策\"\u003e\u003ca href=\"#解決策\"\u003e解決策\u003c/a\u003e\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e作業ユーザを\u003ccode\u003evideo\u003c/code\u003eグループに追加する.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eusergroupは以下で確認できる.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-sh\"\u003e\u003ccode class=\"language-sh\"\u003e$ \u003cspan class=\"token function\"\u003ecut\u003c/span\u003e -d: \u003cspan class=\"token parameter variable\"\u003e-f1\u003c/span\u003e /etc/group\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eそのなかでもメジャーなものは以下(独断).\u003c/p\u003e\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003ctable\u003e\u003cthead\u003e\u003ctr\u003e\u003cth align=\"center\"\u003ename\u003c/th\u003e\u003cth align=\"center\"\u003erole\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd align=\"center\"\u003ewheel\u003c/td\u003e\u003ctd align=\"center\"\u003e管理権限作業用グループ\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd align=\"center\"\u003elog\u003c/td\u003e\u003ctd align=\"center\"\u003e/var/log/ へのアクセス用グループ\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd align=\"center\"\u003evideo\u003c/td\u003e\u003ctd align=\"center\"\u003eビデオキャプチャ・フレームバッファアクセス\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd align=\"center\"\u003edocker\u003c/td\u003e\u003ctd align=\"center\"\u003edocker作業用グループ\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-sh\"\u003e\u003ccode class=\"language-sh\"\u003e\u003cspan class=\"token function\"\u003eusermod\u003c/span\u003e \u003cspan class=\"token parameter variable\"\u003e-aG\u003c/span\u003e video \u003cspan class=\"token variable\"\u003e${\u003cspan class=\"token environment constant\"\u003eUSER\u003c/span\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003eusermod\u003c/code\u003eコマンドを用いて\u003ccode\u003e$USER\u003c/code\u003eをグループに追加する.\u003cbr\u003e\n例えば\u003ccode\u003e$USER\u003c/code\u003eを\u003ccode\u003edocker\u003c/code\u003eグループに追加した場合, \u003ccode\u003e$USER\u003c/code\u003eは\u003ccode\u003edocker\u003c/code\u003eの操作に管理者権限が不要となる.\u003c/p\u003e\n\u003cp\u003e(ただ第三者が作成したスクリプトであってもroot権限で実行できるということなので，\u003ccode\u003edocker\u003c/code\u003eを用いる場合には\u003ccode\u003enewgrp\u003c/code\u003eを用いて一時的にグループを変更するなどのほうがいいと思う. \u003ccode\u003edocker\u003c/code\u003eの場合権限昇格などのリスクもあるので気をつけよう．お兄さんとの約束だよ)\u003c/p\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003e\u003ccode\u003ebrightness\u003c/code\u003eデバイスの書き込み権限を\u003ccode\u003evideo\u003c/code\u003eグループに付与する.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e画面の明るさ(\u003ccode\u003ebrightness\u003c/code\u003e)は\u003ccode\u003eudev\u003c/code\u003eによって管理されている.\n\u003ccode\u003e/usr/lib/udev/rules.d/xx-brightness.rules\u003c/code\u003eを次のように記述する.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-unknown\"\u003e\u003ccode class=\"language-unknown\"\u003eACTION==\u0026#x26;quot;add\u0026#x26;quot;, SUBSYSTEM==\u0026#x26;quot;backlight\u0026#x26;quot;, RUN+=\u0026#x26;quot;/bin/chgrp video /sys/class/backlight/%k/brightness\u0026#x26;quot;\nACTION==\u0026#x26;quot;add\u0026#x26;quot;, SUBSYSTEM==\u0026#x26;quot;backlight\u0026#x26;quot;, RUN+=\u0026#x26;quot;/bin/chmod g+w /sys/class/backlight/%k/brightness\u0026#x26;quot;\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eこれで起動時に\u003ccode\u003evideo\u003c/code\u003eグループに対して\u003ccode\u003ebrightness\u003c/code\u003eデバイスへの書き込み権限が付与される.\u003c/p\u003e\n\u003ch2 id=\"追記\"\u003e\u003ca href=\"#追記\"\u003e追記\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eかわいい感じになりました. yay\n\u003c/p\u003e\u003cfigure\u003e\u003cimg src=\"./img/desktop.png\" alt=\"\"\u003e\u003cfigcaption\u003eimg.1 \u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\n\u003ch2 id=\"reference\"\u003e\u003ca href=\"#reference\"\u003ereference\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://wiki.archlinux.jp/index.php/%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%81%A8%E3%82%B0%E3%83%AB%E3%83%BC%E3%83%97\" rel=\"nofollow\"\u003earch linux#グループ一覧\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://wiki.archlinux.org/index.php/Backlight\" rel=\"nofollow\"\u003earch linux#brightness\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","description":"バルス","commits":[{"title":"copy md","date":"2021-01-30 22:18:17","hash":"35b550ae","diff":"\u003cdiv class=\"remark-highlight\"\u003e\u003cpre data-file=\"35b550ae.patch\" class=\"language-git language-diff\"\u003e\u003ccode class=\"language-git\"\u003e\u003cspan class=\"token commit-sha1\"\u003ecommit 35b550ae83af4efaeadf33471c8ca8a32c1079c8\u003c/span\u003e\nAuthor: koka \u0026#x26;\u003ca href=\"mailto:lt;koka.code@gmail.com\" class=\"token email-link\"\u003elt;koka.code@gmail.com\u003c/a\u003e\u0026#x26;gt;\nDate:   Sat Jan 30 22:18:17 2021 +0900\n\n  copy md\n\ndiff --git a/_posts/2019-07-27-linux-usergroup.md b/_posts/2019-07-27-linux-usergroup.md\nnew file mode 100644\nindex 0000000..0bafcf1\n\u003cspan class=\"token deleted\"\u003e--- /dev/null\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+++ b/_posts/2019-07-27-linux-usergroup.md\u003c/span\u003e\n\u003cspan class=\"token coord\"\u003e@@ -0,0 +1,65 @@\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+---\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+title: 'Linux: 画面の明るさを変更できなくなった'\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+date: 2019-07-27\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+categories:\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+- diary\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+tags:\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+- Linux\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+- udev\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+description: バルス\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+---\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+## TL; DR\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+- 作業ユーザを`video`グループに追加\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+- udevのrulesを追加し`brightness`デバイスへの書き込み権限を付与\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+## 概要\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+Thinkpad X1 Carbon(2019)を購入したので，Gentooをインストールした. \u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+が，F5, F6での明るさ調整が効かなかった. クッソまぶしい.\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+明るさ調整には`light`コマンドを用いたところ，`sudo light -A 5`のようにroot権限を用いると調整が行えた.\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+## 解決策\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+1. 作業ユーザを`video`グループに追加する.\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+usergroupは以下で確認できる.\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\\```sh\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+$ cut -d: -f1 /etc/group\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\\```\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+そのなかでもメジャーなものは以下(独断).\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+|name|role|\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+|:---:|:---:|\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+|wheel| 管理権限作業用グループ|\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+|log| /var/log/ へのアクセス用グループ|\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+|video| ビデオキャプチャ・フレームバッファアクセス|\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+|docker| docker作業用グループ|\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\\```sh\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+usermod -aG video ${USER}\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\\```\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+`usermod`コマンドを用いて`$USER`をグループに追加する.  \u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+例えば`$USER`を`docker`グループに追加した場合, `$USER`は`docker`の操作に管理者権限が不要となる.  \u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+(ただ第三者が作成したスクリプトであってもroot権限で実行できるということなので，`docker`を用いる場合には`newgrp`を用いて一時的にグループを変更するなどのほうがいいと思う. `docker`の場合権限昇格などのリスクもあるので気をつけよう．お兄さんとの約束だよ)\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+2. `brightness`デバイスの書き込み権限を`video`グループに付与する.\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+画面の明るさ(`brightness`)は`udev`によって管理されている. \u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+`/usr/lib/udev/rules.d/xx-brightness.rules`を次のように記述する.\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\\```\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+ACTION==\"add\", SUBSYSTEM==\"backlight\", RUN+=\"/bin/chgrp video /sys/class/backlight/%k/brightness\"\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+ACTION==\"add\", SUBSYSTEM==\"backlight\", RUN+=\"/bin/chmod g+w /sys/class/backlight/%k/brightness\"\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\\```\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+これで起動時に`video`グループに対して`brightness`デバイスへの書き込み権限が付与される.\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+## 追記\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+かわいい感じになりました. yay\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+![](./img/desktop.png)\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+## reference\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+- [arch linux#グループ一覧](https://wiki.archlinux.jp/index.php/%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%81%A8%E3%82%B0%E3%83%AB%E3%83%BC%E3%83%97)\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+- [arch linux#brightness](https://wiki.archlinux.org/index.php/Backlight)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e"}],"publishedAt":"2019-07-27","updatedAt":"2021-01-30"}},"__N_SSG":true},"page":"/archives/[slug]","query":{"slug":"2019-07-27-linux-usergroup"},"buildId":"RxIqu_vluEpaYq5AlkUYa","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>