<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width" data-next-head=""/><meta name="theme-color" content="#ddd4bb" data-next-head=""/><meta property="og:type" content="website" data-next-head=""/><meta property="og:url" content="https://koka831.github.io" data-next-head=""/><meta property="og:site_name" content="/var/log/koka" data-next-head=""/><meta name="twitter:card" content="summary" data-next-head=""/><meta name="twitter:title" content="/var/log/koka" data-next-head=""/><meta name="twitter:site" content="@k_0ka" data-next-head=""/><meta name="twitter:description" content="cat /var/log/koka &gt; /dev/null" data-next-head=""/><link rel="alternate" type="application/rss+xml" href="https://koka831.github.io/feed.xml" title="/var/log/koka RSS2.0" data-next-head=""/><title data-next-head=""></title><meta property="title" content="Nuxt.js: sharing components | /var/log/koka" data-next-head=""/><meta property="og:title" content="Nuxt.js: sharing components | /var/log/koka" data-next-head=""/><meta property="twitter:title" content="Nuxt.js: sharing components | /var/log/koka" data-next-head=""/><meta property="description" content="simple way to share components between multiple projects" data-next-head=""/><meta property="og:description" content="simple way to share components between multiple projects" data-next-head=""/><meta property="twitter:description" content="simple way to share components between multiple projects" data-next-head=""/><meta property="og:image" content="https://koka831.github.io/img/icon.png" data-next-head=""/><link rel="preload" href="/_next/static/css/831b54b7e4e0da27.css" as="style"/><link rel="preload" href="/_next/static/css/5709b986f32934dd.css" as="style"/><link rel="stylesheet" href="/_next/static/css/831b54b7e4e0da27.css" data-n-g=""/><link rel="stylesheet" href="/_next/static/css/5709b986f32934dd.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-8cac0b4b405cede1.js" defer=""></script><script src="/_next/static/chunks/framework-b8ed9b642a1d405a.js" defer=""></script><script src="/_next/static/chunks/main-5967226b86c09d72.js" defer=""></script><script src="/_next/static/chunks/pages/_app-87775d45a97146af.js" defer=""></script><script src="/_next/static/chunks/98bef5de-90a314e763d10677.js" defer=""></script><script src="/_next/static/chunks/230-8a10a6030a242aaa.js" defer=""></script><script src="/_next/static/chunks/772-fdba437487b25e1a.js" defer=""></script><script src="/_next/static/chunks/pages/archives/%5Bslug%5D-b8acdcd8cf8bec23.js" defer=""></script><script src="/_next/static/obcyX-8v16tO1HezZtnFf/_buildManifest.js" defer=""></script><script src="/_next/static/obcyX-8v16tO1HezZtnFf/_ssgManifest.js" defer=""></script></head><body><div id="__next"><nav class="Header_navigation__container__QTqC2"><div class="Header_navigation___WOtz"><a href="/">/var/log/koka</a></div><div><a href="/archives">archive</a></div></nav><main class="Layout_container__p0wDU"><div class="slug_container__mEKwJ"><div class="slug_main__Z60A9"><article class="slug_article__bvmhe"><div itemScope="" class="ArticleHeader_header__container__rB6r3"><a class="ArticleHeader_post__title__2kJMT" href="/archives/2019-10-06-nuxt-sharing-component">Nuxt.js: sharing components</a><p>simple way to share components between multiple projects</p><div class="ArticleHeader_flex__HuW5L"><div class="ArticleHeader_post__tags__xNlWQ"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="tags" class="svg-inline--fa fa-tags ArticleHeader_tags__icon__U0ED6" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M345 39.1L472.8 168.4c52.4 53 52.4 138.2 0 191.2L360.8 472.9c-9.3 9.4-24.5 9.5-33.9 .2s-9.5-24.5-.2-33.9L438.6 325.9c33.9-34.3 33.9-89.4 0-123.7L310.9 72.9c-9.3-9.4-9.2-24.6 .2-33.9s24.6-9.2 33.9 .2zM0 229.5V80C0 53.5 21.5 32 48 32H197.5c17 0 33.3 6.7 45.3 18.7l168 168c25 25 25 65.5 0 90.5L277.3 442.7c-25 25-65.5 25-90.5 0l-168-168C6.7 262.7 0 246.5 0 229.5zM144 144a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"></path></svg><p class="Tag_tag__zyzRy">Vue</p></div><div class="ArticleHeader_post__dates__xh42y"><time dateTime="2019-10-06" itemProp="datePublished" class="PublishDate_post__date___a8_6">published: <!-- -->2019-10-06</time><time dateTime="2021-01-30" itemProp="datePublished" class="PublishDate_post__date___a8_6">updated: 2021-01-30</time></div></div></div><div class="slug_article__body__Y96pa"><h2 id="abstract"><a href="#abstract">Abstract</a></h2>
<ul>
<li>single repositoryで複数のprojectを管理する</li>
<li>ビルド時に<code>nuxt.config.js</code>を上書きし, <code>pages</code>をproject毎に分離</li>
</ul>
<h2 id="motivation"><a href="#motivation">Motivation</a></h2>
<ul>
<li><code>admin</code>と<code>user</code>で共通のコンポーネントがある</li>
<li><code>/user</code>, <code>/admin</code> のようにルーティングで分ける方法もあるが, そもそも<code>/admin</code> を外に出したくない(同じ環境で動作させたくない)</li>
</ul>
<h3 id="1-setup-subdir"><a href="#1-setup-subdir">1. setup subdir</a></h3>
<p><a href="https://github.com/nuxt/create-nuxt-app" rel="nofollow">create-nuxt-app</a>で生成したテンプレートを元に, <code>admin/</code>ディレクトリ配下にサブプロジェクトを作成する.</p>
<div class="remark-highlight"><pre class="language-sh"><code class="language-sh">$ <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> admin/<span class="token punctuation">{</span>pages,layouts<span class="token punctuation">}</span>
$ <span class="token function">touch</span> admin/app.config.js
<span class="token variable">$ls</span>
.gitignore
.nuxt/
admin/    <span class="token operator">&#x3C;</span>-- new
  layouts/
  pages/
  app.config.js
assets/
components/
<span class="token punctuation">..</span>.
layouts/  <span class="token operator">&#x3C;</span>-- default
pages/    <span class="token operator">&#x3C;</span>-- default

</code></pre></div>
<h3 id="2-configure-appconfigjs"><a href="#2-configure-appconfigjs">2. configure app.config.js</a></h3>
<p><code>srcDir</code>を<code>admin</code>とすることで, Nuxtがみるプロジェクトが<code>admin/</code>配下になる.
これでNuxtが生成するroutingも<code>admin/pages</code>によるものになる.
そのため, Storeをadmin側でも持ちたい場合は<code>admin/store/</code>を作成する.</p>
<p>また, <code>admin/pages/xxx.vue</code> でも<code>import XXX from '@/components/...</code>のように<code>@</code>を用いる為に<code>build</code>ディレクティブで<code>@ alias</code>を上書きする.<br>
(この設定がない場合, <code>@/../components/...</code>のように root directoryまで1階層のぼる必要がある)</p>
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> merge <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'deepmerge'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> nuxt <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../nuxt.config.js'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> extend <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">srcDir</span><span class="token operator">:</span> __dirname<span class="token punctuation">,</span>
  <span class="token literal-property property">buildDir</span><span class="token operator">:</span> <span class="token string">'.nuxt/admin'</span><span class="token punctuation">,</span>

  <span class="token literal-property property">build</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">extend</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      config<span class="token punctuation">.</span><span class="token property-access">resolve</span><span class="token punctuation">.</span><span class="token property-access">alias</span><span class="token punctuation">[</span><span class="token string">'@'</span><span class="token punctuation">]</span> <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token method function property-access">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'..'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">merge</span><span class="token punctuation">(</span>nuxt<span class="token punctuation">,</span> extend<span class="token punctuation">)</span>
</code></pre></div>
<h3 id="3-configure-packagejson"><a href="#3-configure-packagejson">3. configure package.json</a></h3>
<p><code>nuxt</code>の<code>--config-file</code> オプションを用いて<code>nuxt.config.js</code>を指定する.<br>
これで<code>yarn dev</code>とすればデフォルトの<code>pages</code>が用いられるし, <code>yarn dev:admin</code>とすれば<code>admin/pages</code>が用いられる.</p>
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token punctuation">{</span>
  <span class="token string-property property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">"dev"</span><span class="token operator">:</span> <span class="token string">"nuxt"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"build"</span><span class="token operator">:</span> <span class="token string">"nuxt build"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"start"</span><span class="token operator">:</span> <span class="token string">"nuxt start"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"dev:admin"</span><span class="token operator">:</span> <span class="token string">"nuxt --config-file admin/app.config.js"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"build:admin"</span><span class="token operator">:</span> <span class="token string">"nuxt build --config-file admin/app.config.js"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"start:admin"</span><span class="token operator">:</span> <span class="token string">"nuxt start --config-file admin/app.config.js"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token spread operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div>
<h3 id="appendix-generated-routingnuxtadminrouterjs"><a href="#appendix-generated-routingnuxtadminrouterjs">Appendix: Generated Routing(.nuxt/admin/router.js)</a></h3>
<p><code>yarn build:admin</code>で生成された<code>routes</code> に <code>client</code>側の<code>pages</code>が含まれていないことが確認できる.</p>
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">Vue</span></span> <span class="token keyword module">from</span> <span class="token string">'vue'</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">Router</span></span> <span class="token keyword module">from</span> <span class="token string">'vue-router'</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> interopDefault <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./utils'</span>
<span class="token keyword module">import</span> <span class="token imports">scrollBehavior</span> <span class="token keyword module">from</span> <span class="token string">'./router.scrollBehavior.js'</span>

<span class="token keyword">const</span> <span class="token function-variable function">_0510df08</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">interopDefault</span><span class="token punctuation">(</span><span class="token keyword module">import</span><span class="token punctuation">(</span><span class="token string">'../../admin/pages/index.vue'</span> <span class="token comment">/* webpackChunkName: "pages/index" */</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token maybe-class-name">Vue</span><span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token maybe-class-name">Router</span><span class="token punctuation">)</span>

<span class="token keyword module">export</span> <span class="token keyword">const</span> routerOptions <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'history'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">base</span><span class="token operator">:</span> <span class="token function">decodeURI</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">linkActiveClass</span><span class="token operator">:</span> <span class="token string">'nuxt-link-active'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">linkExactActiveClass</span><span class="token operator">:</span> <span class="token string">'nuxt-link-exact-active'</span><span class="token punctuation">,</span>
  scrollBehavior<span class="token punctuation">,</span>

  <span class="token literal-property property">routes</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
      <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">"/"</span><span class="token punctuation">,</span>
      <span class="token literal-property property">component</span><span class="token operator">:</span> _0510df08<span class="token punctuation">,</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"index"</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

  <span class="token literal-property property">fallback</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span>routerOptions<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div>
<h3 id="repository"><a href="#repository">repository</a></h3>
<p><a href="https://github.com/koka831/nuxt-multiple-sample" rel="nofollow">koka831/nuxt-multiple-sample</a></p></div></article><div class="CommitLogs_commit_logs__5HqJt" role="log"><h2>Commits</h2><details><summary class="CommitLogs_summary__ZlqPh"><span class="CommitLogs_commit__date__m2ycj">2021-01-30 22:18:17</span><span class="CommitLogs_commit__hash__wzS9A">35b550ae</span><span class="CommitLogs_commit__message__q7MGV">copy md</span></summary><div><div class="remark-highlight"><pre data-file="35b550ae.patch" class="language-git language-diff"><code class="language-git"><span class="token commit-sha1">commit 35b550ae83af4efaeadf33471c8ca8a32c1079c8</span>
Author: koka &#x26;<a href="mailto:lt;koka.code@gmail.com" class="token email-link">lt;koka.code@gmail.com</a>&#x26;gt;
Date:   Sat Jan 30 22:18:17 2021 +0900

  copy md

diff --git a/_posts/2019-10-06-nuxt-sharing-component.md b/_posts/2019-10-06-nuxt-sharing-component.md
new file mode 100644
index 0000000..6daf63f
<span class="token deleted">--- /dev/null</span>
<span class="token inserted">+++ b/_posts/2019-10-06-nuxt-sharing-component.md</span>
<span class="token coord">@@ -0,0 +1,124 @@</span>
<span class="token inserted">+---</span>
<span class="token inserted">+title: 'Nuxt.js: sharing components'</span>
<span class="token inserted">+date: 2019-10-06</span>
<span class="token inserted">+categories:</span>
<span class="token inserted">+- memo</span>
<span class="token inserted">+tags:</span>
<span class="token inserted">+- Vue</span>
<span class="token inserted">+description: simple way to share components between multiple projects</span>
<span class="token inserted">+---</span>
<span class="token inserted">+</span>
<span class="token inserted">+## Abstract</span>
<span class="token inserted">+- single repositoryで複数のprojectを管理する</span>
<span class="token inserted">+- ビルド時に`nuxt.config.js`を上書きし, `pages`をproject毎に分離</span>
<span class="token inserted">+</span>
<span class="token inserted">+## Motivation</span>
<span class="token inserted">+- `admin`と`user`で共通のコンポーネントがある</span>
<span class="token inserted">+- `/user`, `/admin` のようにルーティングで分ける方法もあるが, そもそも`/admin` を外に出したくない(同じ環境で動作させたくない)</span>
<span class="token inserted">+</span>
<span class="token inserted">+### 1. setup subdir</span>
<span class="token inserted">+[create-nuxt-app](https://github.com/nuxt/create-nuxt-app)で生成したテンプレートを元に, `admin/`ディレクトリ配下にサブプロジェクトを作成する.</span>
<span class="token inserted">+</span>
<span class="token inserted">+\```sh</span>
<span class="token inserted">+$ mkdir -p admin/{pages,layouts}</span>
<span class="token inserted">+$ touch admin/app.config.js</span>
<span class="token inserted">+$ls</span>
<span class="token inserted">+.gitignore</span>
<span class="token inserted">+.nuxt/</span>
<span class="token inserted">+admin/    &#x26;lt;-- new</span>
<span class="token inserted">+  layouts/</span>
<span class="token inserted">+  pages/</span>
<span class="token inserted">+  app.config.js</span>
<span class="token inserted">+assets/</span>
<span class="token inserted">+components/</span>
<span class="token inserted">+...</span>
<span class="token inserted">+layouts/  &#x26;lt;-- default</span>
<span class="token inserted">+pages/    &#x26;lt;-- default</span>
<span class="token inserted">+</span>
<span class="token inserted">+\```</span>
<span class="token inserted">+</span>
<span class="token inserted">+</span>
<span class="token inserted">+### 2. configure app.config.js</span>
<span class="token inserted">+`srcDir`を`admin`とすることで, Nuxtがみるプロジェクトが`admin/`配下になる.</span>
<span class="token inserted">+これでNuxtが生成するroutingも`admin/pages`によるものになる.</span>
<span class="token inserted">+そのため, Storeをadmin側でも持ちたい場合は`admin/store/`を作成する.</span>
<span class="token inserted">+</span>
<span class="token inserted">+</span>
<span class="token inserted">+また, `admin/pages/xxx.vue` でも`import XXX from '@/components/...`のように`@`を用いる為に`build`ディレクティブで`@ alias`を上書きする.  </span>
<span class="token inserted">+(この設定がない場合, `@/../components/...`のように root directoryまで1階層のぼる必要がある)</span>
<span class="token inserted">+</span>
<span class="token inserted">+\```js</span>
<span class="token inserted">+const path = require('path')</span>
<span class="token inserted">+const merge = require('deepmerge')</span>
<span class="token inserted">+const nuxt = require('../nuxt.config.js')</span>
<span class="token inserted">+</span>
<span class="token inserted">+const extend = {</span>
<span class="token inserted">+  srcDir: __dirname,</span>
<span class="token inserted">+  buildDir: '.nuxt/admin',</span>
<span class="token inserted">+</span>
<span class="token inserted">+  build: {</span>
<span class="token inserted">+    extend(config) {</span>
<span class="token inserted">+      config.resolve.alias['@'] = path.resolve(__dirname, '..')</span>
<span class="token inserted">+    }</span>
<span class="token inserted">+  }</span>
<span class="token inserted">+}</span>
<span class="token inserted">+</span>
<span class="token inserted">+export default merge(nuxt, extend)</span>
<span class="token inserted">+\```</span>
<span class="token inserted">+</span>
<span class="token inserted">+### 3. configure package.json</span>
<span class="token inserted">+`nuxt`の`--config-file` オプションを用いて`nuxt.config.js`を指定する.  </span>
<span class="token inserted">+これで`yarn dev`とすればデフォルトの`pages`が用いられるし, `yarn dev:admin`とすれば`admin/pages`が用いられる.</span>
<span class="token inserted">+</span>
<span class="token inserted">+\```js</span>
<span class="token inserted">+{</span>
<span class="token inserted">+  "scripts": {</span>
<span class="token inserted">+    "dev": "nuxt",</span>
<span class="token inserted">+    "build": "nuxt build",</span>
<span class="token inserted">+    "start": "nuxt start",</span>
<span class="token inserted">+    "dev:admin": "nuxt --config-file admin/app.config.js",</span>
<span class="token inserted">+    "build:admin": "nuxt build --config-file admin/app.config.js",</span>
<span class="token inserted">+    "start:admin": "nuxt start --config-file admin/app.config.js",</span>
<span class="token inserted">+  },</span>
<span class="token inserted">+  ...</span>
<span class="token inserted">+}</span>
<span class="token inserted">+\```</span>
<span class="token inserted">+</span>
<span class="token inserted">+</span>
<span class="token inserted">+### Appendix: Generated Routing(.nuxt/admin/router.js)</span>
<span class="token inserted">+`yarn build:admin`で生成された`routes` に `client`側の`pages`が含まれていないことが確認できる.</span>
<span class="token inserted">+</span>
<span class="token inserted">+</span>
<span class="token inserted">+\```js</span>
<span class="token inserted">+import Vue from 'vue'</span>
<span class="token inserted">+import Router from 'vue-router'</span>
<span class="token inserted">+import { interopDefault } from './utils'</span>
<span class="token inserted">+import scrollBehavior from './router.scrollBehavior.js'</span>
<span class="token inserted">+</span>
<span class="token inserted">+const _0510df08 = () =&#x26;gt; interopDefault(import('../../admin/pages/index.vue' /* webpackChunkName: "pages/index" */))</span>
<span class="token inserted">+</span>
<span class="token inserted">+Vue.use(Router)</span>
<span class="token inserted">+</span>
<span class="token inserted">+export const routerOptions = {</span>
<span class="token inserted">+  mode: 'history',</span>
<span class="token inserted">+  base: decodeURI('/'),</span>
<span class="token inserted">+  linkActiveClass: 'nuxt-link-active',</span>
<span class="token inserted">+  linkExactActiveClass: 'nuxt-link-exact-active',</span>
<span class="token inserted">+  scrollBehavior,</span>
<span class="token inserted">+</span>
<span class="token inserted">+  routes: [{</span>
<span class="token inserted">+      path: "/",</span>
<span class="token inserted">+      component: _0510df08,</span>
<span class="token inserted">+      name: "index"</span>
<span class="token inserted">+    }],</span>
<span class="token inserted">+</span>
<span class="token inserted">+  fallback: false</span>
<span class="token inserted">+}</span>
<span class="token inserted">+</span>
<span class="token inserted">+export function createRouter() {</span>
<span class="token inserted">+  return new Router(routerOptions)</span>
<span class="token inserted">+}</span>
<span class="token inserted">+\```</span>
<span class="token inserted">+</span>
<span class="token inserted">+### repository</span>
<span class="token inserted">+[koka831/nuxt-multiple-sample](https://github.com/koka831/nuxt-multiple-sample)</span>
</code></pre></div></div></details></div><div class="Comments_comment__S1sQU" role="comment"><h2 class="Comments_title__494X3">Comments</h2><div id="github-comment-container"></div></div></div><aside class="slug_aside__Ow2nH"><nav class="Toc_toc__nav__MM10v"><ul class="Toc_toc__f9CQa"></ul></nav></aside></div></main><footer class="Footer_footer__UaG1g"><small>Code snippets licensed under MIT, unless otherwise noted.</small></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"slug":"2019-10-06-nuxt-sharing-component","title":"Nuxt.js: sharing components","categories":["memo"],"image":"https://koka831.github.io/img/icon.png","tags":["Vue"],"content":"\u003ch2 id=\"abstract\"\u003e\u003ca href=\"#abstract\"\u003eAbstract\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003esingle repositoryで複数のprojectを管理する\u003c/li\u003e\n\u003cli\u003eビルド時に\u003ccode\u003enuxt.config.js\u003c/code\u003eを上書きし, \u003ccode\u003epages\u003c/code\u003eをproject毎に分離\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"motivation\"\u003e\u003ca href=\"#motivation\"\u003eMotivation\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eadmin\u003c/code\u003eと\u003ccode\u003euser\u003c/code\u003eで共通のコンポーネントがある\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/user\u003c/code\u003e, \u003ccode\u003e/admin\u003c/code\u003e のようにルーティングで分ける方法もあるが, そもそも\u003ccode\u003e/admin\u003c/code\u003e を外に出したくない(同じ環境で動作させたくない)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"1-setup-subdir\"\u003e\u003ca href=\"#1-setup-subdir\"\u003e1. setup subdir\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/nuxt/create-nuxt-app\" rel=\"nofollow\"\u003ecreate-nuxt-app\u003c/a\u003eで生成したテンプレートを元に, \u003ccode\u003eadmin/\u003c/code\u003eディレクトリ配下にサブプロジェクトを作成する.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-sh\"\u003e\u003ccode class=\"language-sh\"\u003e$ \u003cspan class=\"token function\"\u003emkdir\u003c/span\u003e \u003cspan class=\"token parameter variable\"\u003e-p\u003c/span\u003e admin/\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003epages,layouts\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003etouch\u003c/span\u003e admin/app.config.js\n\u003cspan class=\"token variable\"\u003e$ls\u003c/span\u003e\n.gitignore\n.nuxt/\nadmin/    \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e-- new\n  layouts/\n  pages/\n  app.config.js\nassets/\ncomponents/\n\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e.\nlayouts/  \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e-- default\npages/    \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e-- default\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3 id=\"2-configure-appconfigjs\"\u003e\u003ca href=\"#2-configure-appconfigjs\"\u003e2. configure app.config.js\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003esrcDir\u003c/code\u003eを\u003ccode\u003eadmin\u003c/code\u003eとすることで, Nuxtがみるプロジェクトが\u003ccode\u003eadmin/\u003c/code\u003e配下になる.\nこれでNuxtが生成するroutingも\u003ccode\u003eadmin/pages\u003c/code\u003eによるものになる.\nそのため, Storeをadmin側でも持ちたい場合は\u003ccode\u003eadmin/store/\u003c/code\u003eを作成する.\u003c/p\u003e\n\u003cp\u003eまた, \u003ccode\u003eadmin/pages/xxx.vue\u003c/code\u003e でも\u003ccode\u003eimport XXX from '@/components/...\u003c/code\u003eのように\u003ccode\u003e@\u003c/code\u003eを用いる為に\u003ccode\u003ebuild\u003c/code\u003eディレクティブで\u003ccode\u003e@ alias\u003c/code\u003eを上書きする.\u003cbr\u003e\n(この設定がない場合, \u003ccode\u003e@/../components/...\u003c/code\u003eのように root directoryまで1階層のぼる必要がある)\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e path \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003erequire\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'path'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e merge \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003erequire\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'deepmerge'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e nuxt \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003erequire\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'../nuxt.config.js'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e extend \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003esrcDir\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e __dirname\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003ebuildDir\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'.nuxt/admin'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\n  \u003cspan class=\"token literal-property property\"\u003ebuild\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003eextend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003econfig\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      config\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eresolve\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ealias\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'@'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e path\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eresolve\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e__dirname\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'..'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003edefault\u003c/span\u003e \u003cspan class=\"token function\"\u003emerge\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003enuxt\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e extend\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3 id=\"3-configure-packagejson\"\u003e\u003ca href=\"#3-configure-packagejson\"\u003e3. configure package.json\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003enuxt\u003c/code\u003eの\u003ccode\u003e--config-file\u003c/code\u003e オプションを用いて\u003ccode\u003enuxt.config.js\u003c/code\u003eを指定する.\u003cbr\u003e\nこれで\u003ccode\u003eyarn dev\u003c/code\u003eとすればデフォルトの\u003ccode\u003epages\u003c/code\u003eが用いられるし, \u003ccode\u003eyarn dev:admin\u003c/code\u003eとすれば\u003ccode\u003eadmin/pages\u003c/code\u003eが用いられる.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token string-property property\"\u003e\"scripts\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token string-property property\"\u003e\"dev\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"nuxt\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token string-property property\"\u003e\"build\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"nuxt build\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token string-property property\"\u003e\"start\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"nuxt start\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token string-property property\"\u003e\"dev:admin\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"nuxt --config-file admin/app.config.js\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token string-property property\"\u003e\"build:admin\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"nuxt build --config-file admin/app.config.js\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token string-property property\"\u003e\"start:admin\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"nuxt start --config-file admin/app.config.js\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token spread operator\"\u003e...\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3 id=\"appendix-generated-routingnuxtadminrouterjs\"\u003e\u003ca href=\"#appendix-generated-routingnuxtadminrouterjs\"\u003eAppendix: Generated Routing(.nuxt/admin/router.js)\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eyarn build:admin\u003c/code\u003eで生成された\u003ccode\u003eroutes\u003c/code\u003e に \u003ccode\u003eclient\u003c/code\u003e側の\u003ccode\u003epages\u003c/code\u003eが含まれていないことが確認できる.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003e\u003cspan class=\"token maybe-class-name\"\u003eVue\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'vue'\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003e\u003cspan class=\"token maybe-class-name\"\u003eRouter\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'vue-router'\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e interopDefault \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./utils'\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003escrollBehavior\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./router.scrollBehavior.js'\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token function-variable function\"\u003e_0510df08\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token function\"\u003einteropDefault\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'../../admin/pages/index.vue'\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* webpackChunkName: \"pages/index\" */\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token maybe-class-name\"\u003eVue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003euse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token maybe-class-name\"\u003eRouter\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e routerOptions \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003emode\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'history'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003ebase\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token function\"\u003edecodeURI\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'/'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003elinkActiveClass\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'nuxt-link-active'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003elinkExactActiveClass\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'nuxt-link-exact-active'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  scrollBehavior\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\n  \u003cspan class=\"token literal-property property\"\u003eroutes\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003epath\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"/\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003ecomponent\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e _0510df08\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003ename\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"index\"\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\n  \u003cspan class=\"token literal-property property\"\u003efallback\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003efalse\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003ecreateRouter\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eRouter\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003erouterOptions\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3 id=\"repository\"\u003e\u003ca href=\"#repository\"\u003erepository\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/koka831/nuxt-multiple-sample\" rel=\"nofollow\"\u003ekoka831/nuxt-multiple-sample\u003c/a\u003e\u003c/p\u003e","description":"simple way to share components between multiple projects","commits":[{"title":"copy md","date":"2021-01-30 22:18:17","hash":"35b550ae","diff":"\u003cdiv class=\"remark-highlight\"\u003e\u003cpre data-file=\"35b550ae.patch\" class=\"language-git language-diff\"\u003e\u003ccode class=\"language-git\"\u003e\u003cspan class=\"token commit-sha1\"\u003ecommit 35b550ae83af4efaeadf33471c8ca8a32c1079c8\u003c/span\u003e\nAuthor: koka \u0026#x26;\u003ca href=\"mailto:lt;koka.code@gmail.com\" class=\"token email-link\"\u003elt;koka.code@gmail.com\u003c/a\u003e\u0026#x26;gt;\nDate:   Sat Jan 30 22:18:17 2021 +0900\n\n  copy md\n\ndiff --git a/_posts/2019-10-06-nuxt-sharing-component.md b/_posts/2019-10-06-nuxt-sharing-component.md\nnew file mode 100644\nindex 0000000..6daf63f\n\u003cspan class=\"token deleted\"\u003e--- /dev/null\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+++ b/_posts/2019-10-06-nuxt-sharing-component.md\u003c/span\u003e\n\u003cspan class=\"token coord\"\u003e@@ -0,0 +1,124 @@\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+---\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+title: 'Nuxt.js: sharing components'\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+date: 2019-10-06\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+categories:\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+- memo\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+tags:\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+- Vue\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+description: simple way to share components between multiple projects\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+---\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+## Abstract\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+- single repositoryで複数のprojectを管理する\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+- ビルド時に`nuxt.config.js`を上書きし, `pages`をproject毎に分離\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+## Motivation\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+- `admin`と`user`で共通のコンポーネントがある\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+- `/user`, `/admin` のようにルーティングで分ける方法もあるが, そもそも`/admin` を外に出したくない(同じ環境で動作させたくない)\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+### 1. setup subdir\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+[create-nuxt-app](https://github.com/nuxt/create-nuxt-app)で生成したテンプレートを元に, `admin/`ディレクトリ配下にサブプロジェクトを作成する.\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\\```sh\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+$ mkdir -p admin/{pages,layouts}\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+$ touch admin/app.config.js\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+$ls\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+.gitignore\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+.nuxt/\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+admin/    \u0026#x26;lt;-- new\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+  layouts/\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+  pages/\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+  app.config.js\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+assets/\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+components/\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+...\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+layouts/  \u0026#x26;lt;-- default\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+pages/    \u0026#x26;lt;-- default\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\\```\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+### 2. configure app.config.js\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+`srcDir`を`admin`とすることで, Nuxtがみるプロジェクトが`admin/`配下になる.\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+これでNuxtが生成するroutingも`admin/pages`によるものになる.\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+そのため, Storeをadmin側でも持ちたい場合は`admin/store/`を作成する.\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+また, `admin/pages/xxx.vue` でも`import XXX from '@/components/...`のように`@`を用いる為に`build`ディレクティブで`@ alias`を上書きする.  \u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+(この設定がない場合, `@/../components/...`のように root directoryまで1階層のぼる必要がある)\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\\```js\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+const path = require('path')\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+const merge = require('deepmerge')\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+const nuxt = require('../nuxt.config.js')\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+const extend = {\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+  srcDir: __dirname,\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+  buildDir: '.nuxt/admin',\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+  build: {\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+    extend(config) {\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+      config.resolve.alias['@'] = path.resolve(__dirname, '..')\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+    }\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+  }\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+}\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+export default merge(nuxt, extend)\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\\```\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+### 3. configure package.json\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+`nuxt`の`--config-file` オプションを用いて`nuxt.config.js`を指定する.  \u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+これで`yarn dev`とすればデフォルトの`pages`が用いられるし, `yarn dev:admin`とすれば`admin/pages`が用いられる.\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\\```js\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+{\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+  \"scripts\": {\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+    \"dev\": \"nuxt\",\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+    \"build\": \"nuxt build\",\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+    \"start\": \"nuxt start\",\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+    \"dev:admin\": \"nuxt --config-file admin/app.config.js\",\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+    \"build:admin\": \"nuxt build --config-file admin/app.config.js\",\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+    \"start:admin\": \"nuxt start --config-file admin/app.config.js\",\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+  },\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+  ...\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+}\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\\```\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+### Appendix: Generated Routing(.nuxt/admin/router.js)\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+`yarn build:admin`で生成された`routes` に `client`側の`pages`が含まれていないことが確認できる.\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\\```js\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+import Vue from 'vue'\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+import Router from 'vue-router'\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+import { interopDefault } from './utils'\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+import scrollBehavior from './router.scrollBehavior.js'\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+const _0510df08 = () =\u0026#x26;gt; interopDefault(import('../../admin/pages/index.vue' /* webpackChunkName: \"pages/index\" */))\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+Vue.use(Router)\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+export const routerOptions = {\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+  mode: 'history',\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+  base: decodeURI('/'),\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+  linkActiveClass: 'nuxt-link-active',\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+  linkExactActiveClass: 'nuxt-link-exact-active',\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+  scrollBehavior,\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+  routes: [{\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+      path: \"/\",\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+      component: _0510df08,\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+      name: \"index\"\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+    }],\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+  fallback: false\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+}\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+export function createRouter() {\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+  return new Router(routerOptions)\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+}\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\\```\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+### repository\u003c/span\u003e\n\u003cspan class=\"token inserted\"\u003e+[koka831/nuxt-multiple-sample](https://github.com/koka831/nuxt-multiple-sample)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e"}],"publishedAt":"2019-10-06","updatedAt":"2021-01-30"}},"__N_SSG":true},"page":"/archives/[slug]","query":{"slug":"2019-10-06-nuxt-sharing-component"},"buildId":"obcyX-8v16tO1HezZtnFf","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>